<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Attendance History</title>
  <link rel="stylesheet" href="Archive.css">
</head>
<body>
  <div class="container">
    <h1>ðŸ“‹ Attendance History</h1>
    <table class="attendance-table">
      <thead>
        <tr>
          <th>Full Name</th>
          <th>Class</th>
          <th>Date</th>
          <th>Status</th>
        </tr>
      </thead>
       <tbody id="attendance-table-body">
      <!-- JS will populate this -->
    </tbody>
    </table>
  </div>

  <script>
    const studentId = localStorage.getItem("studentId");  // Ensure this is set during login

    async function fetchAttendance() {
      try {
        const response = await fetch(`http://127.0.0.1:8000/api/archive-attendance/${studentId}/`);
        const data = await response.json();

        const tbody = document.getElementById("attendance-table-body");
        tbody.innerHTML = ""; // Clear existing rows

        data.forEach(record => {
          const row = document.createElement("tr");

          row.innerHTML = `
            <td>${record.student_name}</td>
            <td>${record.class_name}</td>
            <td>${record.date}</td>
            <td class="${record.isPresent ? 'present' : 'absent'}">
              ${record.isPresent ? 'Present' : 'Absent'}
            </td>
          `;

          tbody.appendChild(row);
        });
      } catch (err) {
        console.error("Error fetching attendance:", err);
        alert("Could not load attendance data.");
      }
    }

    fetchAttendance();
    </script>
 
</body>
</html>
